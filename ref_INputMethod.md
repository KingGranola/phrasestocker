


# 🎹 PhraseStocker 入力・操作ガイド (MuseScoreスタイル)

このドキュメントでは、Ver2.2で導入されたMuseScoreライクな入力メソッドと操作方法について説明します。

---

## 1. モードの概念

アプリケーションには主に2つのモードがあります。

### 🎵 音符入力モード (Note Input Mode)
*   **ショートカット**: `N` キー
*   **状態**: ツールバーの「音符入力モード」ボタンが点灯します。マウスカーソルにゴーストノートが追従します。
*   **用途**: 新しい音符を五線譜に追加する際に使用します。
*   **終了**: `N` キーまたは `Esc` キーを押すと終了し、選択モードに戻ります。

### ↖️ 選択モード (Normal / Selection Mode)
*   **ショートカット**: `Esc` キー
*   **状態**: 音符入力モードがOFFの状態です。
*   **用途**:
    *   音符の選択（クリック）
    *   音高の変更（矢印キー）
    *   音符の削除（Deleteキー）
    *   プロパティ（臨時記号など）の変更
*   **特徴**: `Esc` キーを押すと、いつでもこのモードに戻り、現在の選択状態も解除されます。

---

## 2. 音符と休符の入力手順

MuseScoreの「ステップタイム入力」のワークフローを踏襲しています。

### 基本ステップ
1.  **音符入力モードに入る**: `N` キーを押します。
2.  **長さを選択する**:
    *   `1`: 全音符 (Whole)
    *   `2`: 二分音符 (Half)
    *   `4`: 四分音符 (Quarter) - **デフォルト**
    *   `8`: 八分音符 (Eighth)
    *   `16`: 十六分音符 (Sixteenth) (ショートカットなし)
    *   `.`: 付点のON/OFF切り替え
3.  **音高を決める**:
    *   **マウス**: 五線譜上の希望する高さをクリックします。

### 休符の入力
1.  **休符モード**: `0` キーを押して休符モードをONにします（音符入力モード中）。
2.  **配置**: 五線譜をクリックすると、音高に関わらず適切な休符が入力されます。
3.  **解除**: 再度 `0` キーを押すと音符入力に戻ります。

---

## 3. 編集とナビゲーション（キーボード操作）

音符を選択した状態（選択モード）でのキーボード操作一覧です。

| 操作 | キー | 説明 |
|---|---|---|
| **選択解除** | `Esc` | 選択を解除し、入力モードからも抜けます。 |
| **音高を上げる** | `↑` (Up Arrow) | 選択した音符を半音階的（視覚的）に1つ上の位置へ移動します。 |
| **音高を下げる** | `↓` (Down Arrow) | 選択した音符を半音階的（視覚的）に1つ下の位置へ移動します。 |
| **弦を変更 (上)** | `Ctrl` + `↑` | 音高を変えずに、より細い弦（高い弦）のポジションへ移動します。 |
| **弦を変更 (下)** | `Ctrl` + `↓` | 音高を変えずに、より太い弦（低い弦）のポジションへ移動します。 |
| **削除** | `Delete` / `Backspace` | 選択した音符を削除します。 |
| **TAB譜の変更** | **クリック** | **TAB譜上の数字をクリックすると、次の有効なポジション（弦）へ循環して切り替わります。** |

---

## 4. ショートカットキー一覧

### モード切替
*   `N`: 音符入力モード トグル
*   `Esc`: 選択モードへ戻る / 選択解除

### 音価（長さ）
*   `1`: 全音符
*   `2`: 二分音符
*   `4`: 四分音符
*   `8`: 八分音符
*   `.`: 付点

### その他
*   `0`: 休符モード トグル
*   `Space`: 再生 / 停止
*   `Ctrl + Z`: 元に戻す (Undo)
*   `Ctrl + Shift + Z`: やり直し (Redo)

---

## 5. UIの変更点

*   **入力カーソル**: 音符入力モード中は、マウスカーソル位置に半透明の音符（ゴーストノート）が表示され、配置イメージを確認できます。
*   **バリデーション**: 入力しようとする音符が小節の拍数を超える場合、ゴーストノートが赤く表示され、配置がブロックされます。
